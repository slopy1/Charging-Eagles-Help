
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenECU Simulink Troubleshooter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: MATLAB Calm Blue -->
    <!-- Application Structure Plan: A guided, step-by-step interactive troubleshooter. The structure follows a logical diagnostic flow, starting with the most likely and simplest fix, and progressing to more advanced solutions. This sequential, interactive accordion-style layout prevents user overwhelm and provides clear, actionable steps. The goal is to make the complex process of troubleshooting a MATLAB path and initialization issue as simple as possible for the end-user by breaking it down into manageable, self-contained stages with clear instructions and copy-able code snippets. -->
    <!-- Visualization & Content Choices: The primary content is the troubleshooting steps and MATLAB code derived from the source chat log. The goal is to present this information clearly and allow for easy use. Presentation method is an interactive accordion built with HTML/Tailwind. Interactions include expanding/collapsing steps and one-click copying of code snippets to the clipboard. This is justified because it dramatically reduces user error and cognitive load. No charts are necessary; the focus is on instructional clarity. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #F8F7F4;
            color: #333333;
        }
        .troubleshooter-step {
            background-color: #FFFFFF;
            border: 1px solid #EAE8E1;
            transition: all 0.3s ease-in-out;
        }
        .troubleshooter-step[open] {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        .troubleshooter-step summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1rem;
            color: #1a202c;
        }
        .troubleshooter-step summary::-webkit-details-marker {
            display: none;
        }
        .troubleshooter-step summary:after {
            content: '+';
            font-size: 1.5rem;
            color: #4A90E2;
            transition: transform 0.2s;
        }
        .troubleshooter-step[open] summary:after {
            transform: rotate(45deg);
        }
        .step-content {
            padding: 0 1.5rem 1.5rem;
            border-top: 1px solid #EAE8E1;
        }
        .code-block {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: 'Courier New', Courier, monospace;
            position: relative;
            margin-top: 1rem;
            margin-bottom: 1rem;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .copy-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background-color: #4a5568;
            color: #e2e8f0;
            border: none;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background-color 0.2s;
        }
        .copy-btn:hover {
            background-color: #718096;
        }
        .note {
            background-color: #E6F0FA;
            border-left: 4px solid #4A90E2;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.25rem;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 py-8 md:py-12">

        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800">Interactive OpenECU Troubleshooter</h1>
            <p class="text-lg text-gray-600 mt-2">Fix OpenECU blocks not appearing in the Simulink Library Browser.</p>
        </header>

        <main class="max-w-4xl mx-auto space-y-4">
            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 mb-3">Symptom Analysis</h2>
                <p class="text-gray-700">This guide is for a specific issue where the OpenECU blockset is installed and visible with the `ver` command, and blocks appear correctly in provided example models, but they are <strong class="text-red-600">missing</strong> from the main Simulink Library Browser. The `slLibraryBrowser` command often produces many warnings about invalid mask parameters.</p>
                <p class="text-gray-700 mt-2">This strongly indicates that the blockset's initialization script is not running when MATLAB starts.</p>
            </div>

            <details class="troubleshooter-step rounded-lg" id="step1" open>
                <summary>
                    <span>Step 1: Run the Manual Initialization Script</span>
                    <span class="step-indicator">Most Likely Fix</span>
                </summary>
                <div class="step-content">
                    <p class="mt-4 text-gray-700">The most common cause of this issue is that the OpenECU setup script isn't being executed. Running it manually will load the blockset into the current MATLAB session and should immediately solve the problem.</p>
                    <div class="note">
                        <p><strong>Note:</strong> You may need to adjust the path `C:\openecu` to match your actual OpenECU installation directory.</p>
                    </div>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <code>run('C:\openecu\startup_openecu.m')</code>
                    </div>
                    <p class="mt-4 text-gray-700">After running the command above in your MATLAB Command Window, open the Simulink Library Browser again to check if the OpenECU library now appears.</p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <code>slLibraryBrowser</code>
                    </div>
                </div>
            </details>

            <details class="troubleshooter-step rounded-lg" id="step2">
                <summary>
                    <span>Step 2: Apply the Permanent Fix</span>
                    <span class="step-indicator">Recommended</span>
                </summary>
                <div class="step-content">
                    <p class="mt-4 text-gray-700">If Step 1 worked, you should make the change permanent by adding the initialization command to your `startup.m` file. This file runs automatically every time MATLAB starts.</p>
                    <p class="mt-2 text-gray-700"><strong>1. Open your startup.m file for editing:</strong></p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <code>edit startup.m</code>
                    </div>
                    <p class="mt-4 text-gray-700"><strong>2. Add the following line to the end of the file.</strong> Again, adjust the path if your installation location is different.</p>
                     <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <code>run('C:\openecu\startup_openecu.m')</code>
                    </div>
                    <p class="mt-4 text-gray-700"><strong>3. Save the `startup.m` file and restart MATLAB.</strong> The OpenECU library should now load correctly every time.</p>
                </div>
            </details>

            <details class="troubleshooter-step rounded-lg" id="step3">
                <summary>
                    <span>Step 3: Advanced Path & Cache Reset</span>
                    <span class="step-indicator">If Still Not Working</span>
                </summary>
                <div class="step-content">
                    <p class="mt-4 text-gray-700">If the previous steps did not work, your MATLAB path or toolbox cache might be corrupted. The following sequence of commands will completely reset them and re-register the OpenECU toolbox.</p>
                    <div class="note">
                       <p><strong>Warning:</strong> This will remove any other custom paths you have added. You will need to add them back manually afterwards.</p>
                    </div>
                    <p class="mt-2 text-gray-700">Run these commands in the MATLAB Command Window in order:</p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this, true)">Copy All</button>
                        <code id="advanced-code">restoredefaultpath
rehash toolboxcache
savepath
addpath(genpath('C:\openecu'))
savepath
run('C:\openecu\startup_openecu.m')</code>
                    </div>
                    <p class="mt-4 text-gray-700">After running all commands, restart MATLAB and check the Simulink Library Browser.</p>
                </div>
            </details>
            
            <details class="troubleshooter-step rounded-lg" id="step4">
                <summary>
                    <span>Step 4: Alternative Direct Library Access</span>
                    <span class="step-indicator">Last Resort</span>
                </summary>
                <div class="step-content">
                    <p class="mt-4 text-gray-700">OpenECU includes legacy `.mdl` library files. Even if the library browser integration fails, you can often open these files directly to access all the blocks. Try running these commands:</p>
                    <p class="mt-2 text-gray-700"><strong>For the main platform library:</strong></p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <code>open_system('plat_lib')</code>
                    </div>
                     <p class="mt-4 text-gray-700"><strong>For the extended diagnostics library:</strong></p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <code>open_system('plat_lib_ext_diag')</code>
                    </div>
                     <p class="mt-4 text-gray-700">This will open a Simulink window with the library blocks, which you can then copy into your models.</p>
                </div>
            </details>
        </main>
    </div>

    <script>
        function copyCode(button, all = false) {
            let code;
            if (all) {
                code = document.getElementById('advanced-code').innerText;
            } else {
                code = button.nextElementSibling.innerText;
            }
            
            const el = document.createElement('textarea');
            el.value = code;
            document.body.appendChild(el);
            el.select();
            try {
                document.execCommand('copy');
                button.innerText = 'Copied!';
            } catch (err) {
                console.error('Failed to copy text: ', err);
                button.innerText = 'Error';
            }
            document.body.removeChild(el);

            setTimeout(() => {
                button.innerText = all ? 'Copy All' : 'Copy';
            }, 2000);
        }

        document.querySelectorAll('.troubleshooter-step').forEach(step => {
            step.addEventListener('toggle', (event) => {
                if(event.target.open) {
                    event.target.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }
            });
        });
    </script>
</body>
</html>
