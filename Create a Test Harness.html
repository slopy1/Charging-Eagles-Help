<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Guide to Building a BMS Test Harness in Simulink</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />

    <style>
        body {
            font-family: "Inter", sans-serif;
            background-color: #f8fafc;
        }
        .prose h3 {
            margin-bottom: .5em;
        }
        .prose h4 {
            margin-top: 1.5em;
        }
        .prose h5 {
            margin-top: 1.5em;
        }
        .prose ul {
            margin-top: .5em;
        }
        .nav-link.active {
            color: #2563eb;
            font-weight: 600;
            border-bottom-color: #2563eb;
        }
        /* Code Block Styles */
        .details-code-block {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.375rem;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.875rem;
            overflow-x: auto;
            line-height: 1.6;
        }
        /* Figure Caption Styles */
        .figure-caption {
            font-size: 0.8rem;
            color: #64748b;
            margin-top: 0.5rem;
            text-align: center;
        }
    </style>
</head>
<body class="text-slate-800">

<header class="bg-white/90 backdrop-blur-md sticky top-0 z-50 shadow-sm border-b border-slate-200">
    <div class="container mx-auto px-6 py-3 flex justify-between items-center">
        <h1 class="text-xl font-bold text-slate-900">Simulink MIL Test Harness Guide</h1>
        <nav class="hidden md:flex items-center space-x-6 text-sm font-medium text-slate-600">
            <a href="#step1" class="nav-link border-b-2 border-transparent hover:text-blue-600 hover:border-blue-600 transition-colors py-2">Model Prep</a>
            <a href="#step2" class="nav-link border-b-2 border-transparent hover:text-blue-600 hover:border-blue-600 transition-colors py-2">Harness Creation</a>
            <a href="#step3" class="nav-link border-b-2 border-transparent hover:text-blue-600 hover:border-blue-600 transition-colors py-2">Test Authoring</a>
            <a href="#step4" class="nav-link border-b-2 border-transparent hover:text-blue-600 hover:border-blue-600 transition-colors py-2">Execution & Analysis</a>
        </nav>
    </div>
</header>

<main class="container mx-auto px-4 sm:px-6 py-8 sm:py-12">
    <div class="max-w-4xl mx-auto">

        <div class="prose max-w-none text-center mb-16">
            <h2 class="text-4xl font-extrabold text-slate-900">Creating a MIL Test Harness for a BMS</h2>
            <p class="text-lg text-slate-600 mt-4">
                A step-by-step guide to build a Model-in-the-Loop harness for a Battery Management System, following industry best practices.
            </p>
        </div>

        <div class="space-y-16">

            <section id="step1">
                <div class="p-8 bg-white rounded-2xl shadow-lg">
                    <div class="prose max-w-none">
                        <h3 class="flex items-center">
                            <span class="text-5xl font-bold text-blue-200 mr-4">1</span>
                            <span class="text-3xl font-bold text-slate-800">Model Preparation & Requirements Linking</span>
                        </h3>
                        <p>Before testing, the model must be prepared. This involves cleaning up its interfaces and linking it to the system requirements for full traceability, which is crucial for verification and validation.</p>

                        <h4>Key Actions:</h4>
                        <ul>
                            <li><strong>Define Atomic Subsystem:</strong> Ensure the Component-Under-Test (CUT) is an atomic subsystem with clearly defined Inport and Outport blocks for all data signals.</li>
                            <li><strong>Link Requirements:</strong> Use the Simulink Requirements Toolbox to link each part of your model to the corresponding requirement in your System Requirements Document (SRD).</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="step2">
              <div class="p-8 bg-white rounded-2xl shadow-lg">
                <div class="prose max-w-none">
                  <h3 class="flex items-center">
                    <span class="text-5xl font-bold text-blue-200 mr-4">2</span>
                    <span class="text-3xl font-bold text-slate-800">Test Harness Creation</span>
                  </h3>
                  <p>A test harness provides an isolated environment to wrap the Component-Under-Test (CUT). It allows you to feed it controlled inputs (sources) and observe its outputs (sinks) without the rest of the system. First, right-click the subsystem you want to test and select the harness creation option.</p>
            
                  <div class="my-8 text-center">
                    <img src="https://i.imgur.com/qIlwmfg.png" alt="Create Test Harness dialog in Simulink" class="rounded-lg shadow-md border border-slate-200 inline-block max-w-full h-auto" />
                    <p class="figure-caption">
                      Figure 1 — Creating a test harness from a subsystem.
                    </p>
                  </div>
            
                  <h4 class="mt-8">Harness Configuration Options</h4>
                  <p>When creating the harness, you must choose how to provide inputs (Sources) and capture outputs (Sinks). The two most common configurations are using a <strong>Signal Editor</strong> for time-based waveforms or a <strong>Test Sequence</strong> block for event-based logic.</p>

                  <div class="mt-6 p-6 bg-slate-50 rounded-xl border">
                    <h5 class="font-bold text-slate-800">Configuration A: Signal Editor for Time-Based Inputs</h5>
                    <p>This approach is ideal for testing system responses to predefined waveforms over time, such as simulating a sensor's voltage ramp-up during startup or injecting a specific noise pattern.</p>
                    <div class="my-6 text-center">
                        <img src="https://i.imgur.com/FWAytqp.png" alt="A test harness using a Signal Editor block for inputs" class="rounded-lg shadow border border-slate-200 inline-block max-w-full h-auto" />
                        <p class="figure-caption">
                          Figure 2 — A harness where a Signal Editor block provides inputs to the subsystem.
                        </p>
                    </div>
                    <p>The <strong>Signal Editor</strong> block (Figure 2) lets you define one or more input scenarios. Inside the block, you can draw waveforms, import data from a file, or create signals using MATLAB expressions. This gives you precise control over the stimuli your model receives during the simulation.</p>
                     <div class="my-6 text-center">
                        <img src="https://i.imgur.com/lTgbjQW.png" alt="The Signal Editor user interface for defining waveforms" class="rounded-lg shadow border border-slate-200 inline-block max-w-full h-auto" />
                        <p class="figure-caption">
                          Figure 3 — The Signal Editor interface for authoring various input signal scenarios.
                        </p>
                    </div>
                  </div>

                  <div class="mt-8 p-6 bg-slate-50 rounded-xl border">
                    <h5 class="font-bold text-slate-800">Configuration B: Test Sequence for Event-Based Logic</h5>
                    <p>This configuration is best for testing complex, event-driven behavior, such as fault handling, mode switching, or state logic. It allows you to define a series of steps and verify the system's reaction at each stage.</p>
                    <div class="my-6 text-center">
                        <img src="https://i.imgur.com/MqiCqHQ.png" alt="A test harness using a Test Sequence block for inputs and verification" class="rounded-lg shadow border border-slate-200 inline-block max-w-full h-auto" />
                        <p class="figure-caption">
                          Figure 4 — A harness where a Test Sequence block controls inputs and assesses outputs.
                        </p>
                    </div>
                    <p>The <strong>Test Sequence</strong> block (Figure 4) uses a MATLAB-like syntax to activate inputs and perform checks on outputs. You can create complex logic with conditions (`when`), temporal operators (`after`), and verification statements (`verify`). This is powerful for confirming that your system reacts correctly and within the required time to specific events.</p>
                    <div class="my-6 text-center">
                        <img src="https://i.imgur.com/n5MePnL.png" alt="Test Sequence block editor showing verify statements" class="rounded-lg shadow border border-slate-200 inline-block max-w-full h-auto" />
                        <p class="figure-caption">
                          Figure 5 — Defining steps, transitions, and assessments in the Test Sequence editor.
                        </p>
                    </div>
                    <div class="my-6 text-center">
                        <img src="https://i.imgur.com/IHPRzkW.png" alt="Example of Test Sequence syntax for a pre-charge check" class="rounded-lg shadow border border-slate-200 inline-block max-w-full h-auto" />
                        <p class="figure-caption">
                          Figure 6 — An example of Test Sequence syntax for verifying a pre-charge state.
                        </p>
                    </div>
                 </div>
                </div>
              </div>
            </section>

            <section id="step3">
                <div class="p-8 bg-white rounded-2xl shadow-lg">
                    <div class="prose max-w-none">
                        <h3 class="flex items-center">
                            <span class="text-5xl font-bold text-blue-200 mr-4">3</span>
                            <span class="text-3xl font-bold text-slate-800">Test Case Authoring & Assessments</span>
                        </h3>
                        <p>This is where you define the "what" and "how" of your test. A good test case includes realistic stimuli to drive the model and explicit pass/fail criteria (assessments) to verify its behavior.</p>

                        <h4>Part A — Authoring Stimuli</h4>
                        <p>Create input signals that represent both normal operation and fault conditions:</p>
                        <ul>
                            <li><strong>Normal Operation:</strong> A full power-up to shutdown sequence.</li>
                            <li><strong>Fault Injection:</strong> High/low temperature faults, CAN message dropouts, or HVIL PWM signal faults.</li>
                        </ul>

                        <h4>Part B — Defining Assessments</h4>
                        <p>Use <code>verify</code> statements within a Test Sequence block, often combined with temporal operators to check behavior over time.</p>

                        <div class="details-code-block mt-3">
                            <span style="color: #6ee7b7;">// Assessment for a controlled power-down sequence</span><br>
                            <span style="color: #7dd3fc;">when</span> (HCP_ShutDwn_Cmd == INITIATE_POWERDOWN) {<br>
                            &nbsp;&nbsp;<span style="color: #93c5fd;">after</span>(1.2, s, <span style="color: #d8b4fe;">verify</span>(BPCM_InternalState == PRE_SHUTDOWN));<br>
                            }<br><br>
                            <span style="color: #6ee7b7;">// Assessment for a temperature sensor fault reaction</span><br>
                            <span style="color: #7dd3fc;">when</span> (Temp_Sensor_Fault == DETECTED) {<br>
                            &nbsp;&nbsp;<span style="color: #93c5fd;">after</span>(0.1, s, <span style="color: #d8b4fe;">verify</span>(Fault_Reaction_Active == true));<br>
                            &nbsp;&nbsp;<span style="color: #d8b4fe;">verify</span>(Active_Temp_Source == BACKUP_SENSOR);<br>
                            }
                        </div>
                    </div>
                </div>
            </section>

            <section id="step4">
                <div class="p-8 bg-white rounded-2xl shadow-lg">
                    <div class="prose max-w-none">
                        <h3 class="flex items-center">
                            <span class="text-5xl font-bold text-blue-200 mr-4">4</span>
                            <span class="text-3xl font-bold text-slate-800">Execution & Analysis</span>
                        </h3>
                        <p>Finally, run the tests from the Test Manager, inspect the results, analyze code coverage, and generate a formal test report to document your findings.</p>

                        <ul>
                            <li><strong>Run Tests:</strong> Click the "Run" button in the Test Manager to execute all test cases.</li>
                            <li><strong>Analyze Failures:</strong> For any failed test, right-click the result and select "View Simulation Data in SDI" to debug the signals and find the root cause.</li>
                            <li><strong>Measure Coverage:</strong> In the Test Manager, under "Coverage Settings," enable Decision, Condition, and MCDC coverage to ensure your tests are thorough.</li>
                            <li><strong>Generate Report:</strong> Click "Report" to automatically generate a detailed document in HTML or PDF format, including requirements traceability and coverage results.</li>
                        </ul>
                    </div>
                </div>
            </section>

        </div>
    </div>
</main>

<footer class="text-center py-10 mt-16 bg-slate-100 border-t border-slate-200">
    <p class="text-sm text-slate-500">BMS MIL Test Harness Guide — Built for the Battery Workforce Challenge</p>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- Sticky Navigation Highlight on Scroll ---
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('section[id]');

    if (navLinks.length > 0 && sections.length > 0) {
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    navLinks.forEach(link => {
                        link.classList.toggle('active', link.getAttribute('href') === `#${entry.target.id}`);
                    });
                }
            });
        }, {
            rootMargin: '-40% 0px -60% 0px' // Tweak margins to feel more responsive
        });

        sections.forEach(sec => observer.observe(sec));
    }
});
</script>

</body>
</html>
